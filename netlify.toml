# Netlify configuration for Jekyll site
# Main site: https://aly-andrews.github.io (GitHub Pages)
# PR previews: deploy-preview-{PR#}--aly-andrews.netlify.app

[build]
  # Build command for Jekyll
  command = "bundle install && bundle exec jekyll build"
  
  # Directory with the built site
  publish = "_site"
  
  # Environment variables for the build
  # Use Ruby 3.3.4 to match GitHub Pages; Liquid 4.0.4+ is compatible (no tainted? issue)
  [build.environment]
    RUBY_VERSION = "3.3.4"
    JEKYLL_ENV = "production"

# Deploy previews for pull requests (must set Ruby here; context does not inherit [build.environment])
[context.deploy-preview]
  command = "bundle install && bundle exec jekyll build --baseurl ''"
  [context.deploy-preview.environment]
    RUBY_VERSION = "3.3.4"
    JEKYLL_ENV = "production"

# Branch deploys (won't be used since main is on GitHub Pages)
[context.branch-deploy]
  command = "bundle install && bundle exec jekyll build --baseurl ''"

# Production build (won't be used since main is on GitHub Pages)
[context.production]
  command = "bundle install && bundle exec jekyll build --baseurl ''"

# Redirect rules (if needed in future)
# [[redirects]]
#   from = "/old-path"
#   to = "/new-path"
#   status = 301
